<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
/>
<meta
  name="description"
  content="Design and implement your programming language and software analysis tools with mathematical rigor."
/>
<meta name="keywords" content="runtime, verification, rv, k" />
<meta name="author" content="IELE Semantics | Runtime Verification Inc" />
<meta name="robots" content="index, follow" />

<!--favicon icon-->
<link rel="icon" type="image/png" href="../../../assets/img/favicon.ico" />

<title>IELE Semantics | Runtime Verification Inc</title>

<!-- <base href="/k/" /> -->

<!--web fonts-->
<link
  href="https://fonts.googleapis.com/css?family=Nunito:300,400,600,700,800"
  rel="stylesheet"
/>
<link
  href="https://fonts.googleapis.com/css?family=Lora:400i"
  rel="stylesheet"
/>

<link
  href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css"
  rel="stylesheet"
/>

<link href="../../../assets/css/index.css" rel="stylesheet" />

<!--[if (gt IE 9) |!(IE)]><!-->
<!--<link rel="stylesheet" href="/assets/vendor/custom-nav/css/effects/fade-menu.css"/>-->
<!-- <link rel="stylesheet" href="../../../assets/k/vl-nav/css/effects/slide-menu.css" /> -->
<!--<![endif]-->

  </head>

  <body>
<header
  class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar"
>
  <a class="logo-link" href="../../../index.html">
    <img
      class="logo-dark"
      srcset="../../../assets/img/iele-logo.png"
      alt="K"
      style="height: 48px"
    />
    Semantic Framework
  </a>
  <ul class="navbar-nav ml-md-auto">
    <li class="nav-item">
      <a
        class="nav-link pl-2 pr-1 mx-1 py-3 my-n2"
        href="https://github.com/runtimeverification/iele-semantics"
        target="_blank"
        rel="noopener"
        aria-label="GitHub"
      >
        <i class="fab fa-github"></i>
      </a>
    </li>
  </ul>
  <a
    class="btn btn-rv-blue d-none d-lg-inline-block mb-3 mb-md-0 ml-md-3"
    href="../../../downloads"
    >Download</a
  >
</header>


    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 bd-sidebar mb-3">
  <form
    role="search"
    class="bd-search d-flex align-items-center justify-content-between"
  >
    <input
      type="search"
      class="form-control"
      placeholder="Search..."
      aria-label="Search for..."
      autocomplete="false"
      id="search-box"
    />
    <button
      class="btn bd-search-docs-toggle d-md-none p-0 ml-3 collapsed"
      type="button"
      aria-label="Toggle docs navigation"
      style="font-size: 1.4rem"
    >
      <i class="fas fa-bars"></i>
    </button>
  </form>
  <nav class="collapse bd-links" aria-label="Main navigation">
    <div class="bd-toc-item">
      <a class="bd-toc-link" href="../../../">Homepage</a>
      <a class="bd-toc-link" href="../../../INSTALL">Install</a>
      <a class="bd-toc-link" href="../../../Design">Design</a>
    </div>
  </nav>
</div>

        <main
          class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content"
          role="main"
        >
          <div class="markdown-preview"><html><head></head><body><h1>ansi_up.js</h1>
<p><strong>ansi_up</strong> is an easy to use library that transforms text containing
<a href="http://en.wikipedia.org/wiki/ANSI_escape_code#Colors" target="_blank" rel="noopener">ANSI color escape codes</a> into HTML.</p>
<p>This module is a single Javascript file with no dependencies.
It is &quot;isomorphic&quot; javascript. This is just another way of saying that
the ansi_up.js file will work in both the browser or node.js.
The js library is compiled from TypeScript and its type description ships with the NPM.
This code has been used in production since 2011 and is actively maintained.</p>
<p>For example, turn this terminal output:</p>
<pre><code>ESC[1;Foreground
[1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [0m
[1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [0m
[1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [0m
...
</code></pre>
<p>...into this browser output:</p>
<p><img src="https://raw.github.com/drudru/ansi_up/master/sample.png" alt></p>
<h2>Browser Example</h2>
<pre class="hljs"><code>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;ansi_up.js&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript">

    <span class="hljs-keyword">var</span> txt  = <span class="hljs-string">&quot;\n\n\033[1;33;40m 33;40  \033[1;33;41m 33;41  \033[1;33;42m 33;42  \033[1;33;43m 33;43  \033[1;33;44m 33;44  \033[1;33;45m 33;45  \033[1;33;46m 33;46  \033[1m\033[0\n\n\033[1;33;42m &gt;&gt; Tests OK\n\n&quot;</span>

    <span class="hljs-keyword">var</span> ansi_up = <span class="hljs-keyword">new</span> AnsiUp;

    <span class="hljs-keyword">var</span> html = ansi_up.ansi_to_html(txt);

    <span class="hljs-keyword">var</span> cdiv = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;console&quot;</span>);

    cdiv.innerHTML = html;

    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2>Node Example</h2>
<pre class="hljs"><code>    <span class="hljs-keyword">var</span> AU = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;ansi_up&apos;</span>);
    <span class="hljs-keyword">var</span> ansi_up = <span class="hljs-keyword">new</span> AU.default;

    <span class="hljs-keyword">var</span> txt  = <span class="hljs-string">&quot;\n\n\033[1;33;40m 33;40  \033[1;33;41m 33;41  \033[1;33;42m 33;42  \033[1;33;43m 33;43  \033[1;33;44m 33;44  \033[1;33;45m 33;45  \033[1;33;46m 33;46  \033[1m\033[0\n\n\033[1;33;42m &gt;&gt; Tests OK\n\n&quot;</span>

    <span class="hljs-keyword">var</span> html = ansi_up.ansi_to_html(txt);
</code></pre>
<p>More examples are in the &apos;examples&apos; directory in the repo.</p>
<h2>Typescript Example</h2>
<pre class="hljs"><code>    <span class="hljs-keyword">import</span> {
        <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> AnsiUp
    } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;ansi_up&apos;</span>;

    <span class="hljs-keyword">const</span> ansi_up = <span class="hljs-keyword">new</span> AnsiUp();

    <span class="hljs-keyword">const</span> txt  = <span class="hljs-string">&quot;\n\n\x1B[1;33;40m 33;40  \x1B[1;33;41m 33;41  \x1B[1;33;42m 33;42  \x1B[1;33;43m 33;43  \x1B[1;33;44m 33;44  \x1B[1;33;45m 33;45  \x1B[1;33;46m 33;46  \x1B[1m\x1B[0\n\n\x1B[1;33;42m &gt;&gt; Tests OK\n\n&quot;</span>

    <span class="hljs-keyword">let</span> html = ansi_up.ansi_to_html(txt);
</code></pre>
<h2>Installation</h2>
<pre><code>$ npm install ansi_up
</code></pre>
<h2>Versions</h2>
<ul>
<li>Version 4.0 - Re-architect code to support [<a href="https://gist.github.com/egmontkob/eb114294efbcd5adb1944c9f3cb5feda" target="_blank" rel="noopener">https://gist.github.com/egmontkob/eb114294efbcd5adb1944c9f3cb5feda</a>](terminal URL codes).</li>
<li>Version 3.0 - now treats ANSI bold sequences as CSS font-weight:bold</li>
<li>Version 2.0 - moved to a stateful, streaming version of the API</li>
<li>Version 1.3 - was the last of the older, deprecated API.</li>
</ul>
<h2>Quick Start</h2>
<ol>
<li>Use whatever module system to import the <em>ansi_up</em> module.</li>
<li>Instantiate the object.</li>
<li>For every piece of ansi escaped text string, call <strong>ansi_to_html</strong>.</li>
<li>Append the emitted HTML to the previous HTML already emitted.</li>
<li>DONE</li>
</ol>
<h2>API Methods and Recommended Settings</h2>
<p>You only need the ansi_to_html method. The other properties listed below allow you to
override some of the escaping behaviour. You probably don&apos;t need to change these
from their default values.</p>
<p>It is recommended that the HTML container that holds the span tags is styled with a monospace font.
A PRE tag would work just fine for this.
It is also recommended that the HTML container is styled with a black background.
See the examples, for more CSS theming.</p>
<h4>ansi_to_html (txt)</h4>
<p>This transforms ANSI terminal escape codes/sequences into SPAN tags that wrap and style the content.</p>
<p>This method only interprets ANSI SGR (Select Graphic Rendition) codes or escaped URL codes.
For example, cursor movement codes are ignored and hidden from output.</p>
<p>This method also safely escapes any unsafe HTML characters.</p>
<p>The default style uses colors that are very close to the prescribed standard.
The standard assumes that the text will have a black background.
These colors are set as inline styles on the SPAN tags.
Another option is to set the &apos;use_classes&apos; property to true&apos;.
This will instead set classes on the spans so the colors can be set via CSS.
The class names used are of the format <code>ansi-*-fg/bg</code> and <code>ansi-bright-*-fg/bg</code> where * is the colour name, i.e black/red/green/yellow/blue/magenta/cyan/white.
See the examples directory for a complete CSS theme for these classes.</p>
<h2>Properties</h2>
<h4>escape_for_html</h4>
<p>(default: true)</p>
<p>This does the minimum escaping of text to make it compliant with HTML.
In particular, the &apos;&amp;&apos;,&apos;&lt;&apos;, and &apos;&gt;&apos; characters are escaped. It is
** highly ** recommended that you do not set this to false. It will open
the door security vulnerabilities.</p>
<h4>use_classes</h4>
<p>(default: false)</p>
<p>This causes the SPAN tags to use classes to style the SPAN tags instead
of specified RGB values.</p>
<h4>url_whitelist</h4>
<p>(default: { &apos;http&apos;:1, &apos;https&apos;:1 };</p>
<p>This mapping is a whitelist of URI schemes that will be allowed to render HTML anchor tags.</p>
<h2>Buffering</h2>
<p>In general, the ansi_to_html <em>should</em> emit HTML when invoked with a non-empty string.
The only exceptions are an incomplete ESC sequence or an incomplete escaped URL.
For those cases, the library will buffer the escape or the sequence for the escaped URL.</p>
<p>The library is also stateful. If a color is set in a prior invocation, then it will
continue to emit that color in further invocations until the color/SGR attribute is changed.</p>
<h3>Example of a Use Case</h3>
<p>I have used this library to &apos;tail&apos; a file.</p>
<p>On a remote machine, I had process generating a log file.
I had a web server running on the same machine.
The server hosted a simple HTML page that used AJAX to poll an object with a range query.
Specifically I used an HTTP/1.1 GET request with RFC 7233 Range query.
The first range query would start at 0, but then progressively move forward after
new data was received.</p>
<p>For each new chunk of data received, I would transform the data with <em>ansi_up</em>, and append the new
spans to the innerHTML of a PRE tag.</p>
<h3>UTF8 note</h3>
<p>One last important note, <em>ansi_up</em> takes its input in the form of a Javascript string.
These strings are UTF8. When you take the output of some program and send it to
Javascript, there will be buffering. Be sure that you do not send incomplete UTF8 sequences.
Javascript will ignore or drop the sequence from the stream when it converts it to a
string.</p>
<h2>Building</h2>
<p>To build, a simple Makefile handles it all.</p>
<pre class="hljs"><code>    $ make
</code></pre>
<h2>Running tests</h2>
<p>To run the tests for <em>ansi_up</em>, run <code>npm install</code> to install dev dependencies. Then:</p>
<pre class="hljs"><code>    $ make test
</code></pre>
<h2>Credits</h2>
<p>This code was developed by Dru Nelson (<a href="https://github.com/drudru" target="_blank" rel="noopener">https://github.com/drudru</a>).</p>
<p>Thanks goes to the following contributors for their patches:</p>
<ul>
<li>AIZAWA Hina (<a href="https://github.com/fetus-hina" target="_blank" rel="noopener">https://github.com/fetus-hina</a>)</li>
<li>James R. White (<a href="https://github.com/jamesrwhite" target="_blank" rel="noopener">https://github.com/jamesrwhite</a>)</li>
<li>Aaron Stone (<a href="https://github.com/sodabrew" target="_blank" rel="noopener">https://github.com/sodabrew</a>)</li>
<li>Maximilian Antoni (<a href="https://github.com/mantoni" target="_blank" rel="noopener">https://github.com/mantoni</a>)</li>
<li>Jim Bauwens (<a href="https://github.com/jimbauwens" target="_blank" rel="noopener">https://github.com/jimbauwens</a>)</li>
<li>Jacek J&#x119;drzejewski (<a href="https://github.com/eXtreme" target="_blank" rel="noopener">https://github.com/eXtreme</a>)</li>
</ul>
</body></html></div>
        </main>
      </div>
    </div>
<footer class="app-footer text-md-left text-center">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-2 mb-md-0 mb-4">
        <span class="pr-md-5 pr-0 py-3">
          <a href="https://runtimeverification.com" target="_blank">
            <picture>
              <source
                srcset="../../../assets/img/rv-logo-dark.png"
                media="(prefers-color-scheme: dark)"
              />
              <img
                class="pr-3 footer-logo"
                src="../../../assets/img/rv-logo.png"
                alt="Runtime Verification Inc logo"
              />
            </picture>
          </a>
        </span>
      </div>
      <div class="col-md-6 mb-md-0 mb-4"></div>
      <div class="col-md-4 text-md-right">
        <p class="copyright">
          &copy; 2020 Runtime Verification Inc. All right reserved.
        </p>
      </div>
    </div>
  </div>
</footer>

<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-163311512-1"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "UA-163311512-1");
</script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Typist/1.2/typist.min.js"></script>
    <script src="../../../assets/js/index.js"></script>
  </body>
</html>
